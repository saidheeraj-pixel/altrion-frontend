import{j as e,m as r,A as g}from"./animations-DMW0BnLD.js";import{u as k,c as A,r as p}from"./vendor-CInILLWq.js";import{c as w,R as h,C,B as b}from"./index-DmE6YkWe.js";import{C as u}from"./Card-BnPWI7R3.js";import{H as L,C as R,I as d,f as c}from"./formatters-DUDAB8vu.js";import"./chart-objC2bqF.js";import{u as S}from"./state-1cba2Yyk.js";import{W as T}from"./wallet-DhGEl6IA.js";import{F as I}from"./file-text-D9pLg5BT.js";import{C as P}from"./chevron-down-pbJP7GAq.js";import{S as _}from"./shield-BP-rCqRT.js";import{A as E}from"./arrow-left-8h1TeAST.js";import{A as B}from"./arrow-right-B-P9p7S_.js";import"./ThemeToggle-D8B3NSea.js";import"./useAuth-DwNt2FxU.js";const O=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],z=w("chevron-up",O),D="http://localhost:5002",U={async calculateLoan(a){const l=await fetch(`${D}/loan/calculate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok){const n=await l.json().catch(()=>({error:"Unknown error"}));throw new Error(n.error||`API Error: ${l.status}`)}return l.json()}};function M(){return S({mutationFn:a=>U.calculateLoan(a)})}const j={chase:"Chase",bofa:"Bank of America"};function se(){const a=k(),l=A(),n=M(),i=l.state;p.useEffect(()=>{i||a(h.LOAN_APPLICATION)},[i,a]);const[o,N]=p.useState(!1),{loanRequest:t,selectedAssets:m,totalCollateral:x}=i||{loanRequest:null,selectedAssets:[],totalCollateral:0},f=async()=>{if(!(!i||!t))try{const s=await n.mutateAsync(t);a(h.LOAN_SUMMARY,{state:{loanResponse:s,selectedAssets:m,loanRequest:{months:t.months,payout_currency:t.payout_currency,bank:t.bank}}})}catch(s){console.error("Loan calculation failed:",s)}},v=()=>{a(h.LOAN_APPLICATION)};return i?e.jsxs("div",{className:"min-h-screen bg-dark-bg relative",children:[e.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-altrion-500/10 rounded-full blur-[120px] animate-pulse",style:{animationDuration:"8s"}}),e.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-accent-cyan/5 rounded-full blur-[120px] animate-pulse",style:{animationDuration:"10s"}})]}),e.jsx(L,{}),e.jsx("main",{className:"max-w-3xl mx-auto px-5 py-8",children:e.jsxs(r.div,{variants:R,initial:"hidden",animate:"visible",className:"space-y-6",children:[e.jsxs(r.div,{variants:d,className:"text-center",children:[e.jsx(r.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:15,delay:.2},className:"w-16 h-16 mx-auto mb-4 rounded-full bg-amber-500/20 flex items-center justify-center",children:e.jsx(C,{size:36,className:"text-amber-400"})}),e.jsx("h1",{className:"font-display text-3xl font-bold text-text-primary mb-2",children:"Confirm Your Loan Application"}),e.jsx("p",{className:"text-text-secondary",children:"Please review the details below before submitting your application."})]}),e.jsx(r.div,{variants:d,children:e.jsxs(u,{variant:"bordered",className:"border-amber-500/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-altrion-500/20 flex items-center justify-center",children:e.jsx(T,{size:20,className:"text-altrion-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-xl font-semibold text-text-primary",children:"Loan Details"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"Review your loan terms"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-dark-elevated rounded-xl",children:[e.jsx("p",{className:"text-text-muted text-xs mb-1",children:"Total Collateral"}),e.jsx("p",{className:"text-2xl font-bold text-altrion-400",children:c(x)})]}),e.jsxs("div",{className:"p-4 bg-dark-elevated rounded-xl",children:[e.jsx("p",{className:"text-text-muted text-xs mb-1",children:"Loan Term"}),e.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[t?.months||0," months"]})]}),e.jsxs("div",{className:"p-4 bg-dark-elevated rounded-xl",children:[e.jsx("p",{className:"text-text-muted text-xs mb-1",children:"Payout Currency"}),e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:t?.payout_currency||"USD"})]}),e.jsxs("div",{className:"p-4 bg-dark-elevated rounded-xl",children:[e.jsx("p",{className:"text-text-muted text-xs mb-1",children:"Bank Account"}),e.jsx("p",{className:"text-2xl font-bold text-text-primary",children:j[t?.bank||"chase"]||t?.bank})]})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsxs("p",{className:"text-sm font-medium text-text-secondary mb-3",children:["Collateral Assets (",m.length,")"]}),e.jsx("div",{className:"space-y-2",children:m.map((s,y)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-elevated rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-dark-card flex items-center justify-center font-bold text-sm",children:s.symbol.slice(0,2)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary",children:s.name}),e.jsxs("p",{className:"text-text-muted text-sm",children:[s.amount.toLocaleString()," ",s.symbol]})]})]}),e.jsx("p",{className:"font-semibold text-text-primary",children:c(s.value)})]},y))})]})]})}),e.jsx(r.div,{variants:d,children:e.jsxs(u,{variant:"bordered",className:"border-blue-500/30",children:[e.jsxs("button",{onClick:()=>N(!o),className:"w-full flex items-center justify-between p-4 hover:bg-dark-elevated/50 transition-colors rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/20 flex items-center justify-center",children:e.jsx(I,{size:20,className:"text-blue-400"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-display text-xl font-semibold text-text-primary",children:"Loan Summary"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"View estimated loan details"})]})]}),o?e.jsx(z,{size:24,className:"text-text-muted"}):e.jsx(P,{size:24,className:"text-text-muted"})]}),e.jsx(g,{children:o&&e.jsx(r.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-2 border-t border-dark-border mt-2",children:[e.jsx("p",{className:"text-xs text-text-muted mb-4 italic",children:"Note: These are estimated values based on your selected collateral. Final terms will be calculated after submission."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 bg-dark-elevated rounded-lg",children:[e.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Total Collateral"}),e.jsx("p",{className:"text-lg font-bold text-text-primary",children:c(x)})]}),e.jsxs("div",{className:"p-3 bg-dark-elevated rounded-lg",children:[e.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Estimated Loan (75% LTV)"}),e.jsx("p",{className:"text-lg font-bold text-altrion-400",children:c(x*.75)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 bg-dark-elevated rounded-lg",children:[e.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Loan Term"}),e.jsxs("p",{className:"text-lg font-bold text-text-primary",children:[t?.months||0," months"]})]}),e.jsxs("div",{className:"p-3 bg-dark-elevated rounded-lg",children:[e.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Est. Interest Rate"}),e.jsx("p",{className:"text-lg font-bold text-text-primary",children:"~12-18% APR"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-dark-elevated rounded-lg",children:[e.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Payout Currency"}),e.jsx("p",{className:"text-lg font-bold text-text-primary",children:t?.payout_currency||"USD"})]}),e.jsxs("div",{className:"p-3 bg-dark-elevated rounded-lg",children:[e.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Bank Account"}),e.jsx("p",{className:"text-lg font-bold text-text-primary",children:j[t?.bank||"chase"]||t?.bank})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:e.jsxs("p",{className:"text-xs text-amber-400",children:[e.jsx("strong",{children:"Important:"})," Actual loan amount, interest rate, and terms will be determined by our system based on real-time market conditions and asset risk assessment."]})})]})})})]})}),e.jsx(r.div,{variants:d,children:e.jsx(u,{variant:"bordered",className:"bg-amber-500/5 border-amber-500/30",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(_,{size:20,className:"text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-text-primary mb-1",children:"Important Notice"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"By submitting this application, you agree to lock the selected assets as collateral. These assets will be held until the loan is fully repaid. Make sure you understand the terms before proceeding."})]})]})})}),e.jsxs(r.div,{variants:d,className:"flex gap-4 justify-center pt-4",children:[e.jsxs(b,{variant:"secondary",onClick:v,children:[e.jsx(E,{size:16}),"Go Back & Edit"]}),e.jsxs(b,{onClick:f,disabled:n.isPending,children:[n.isPending?"Calculating...":"Continue to Review",!n.isPending&&e.jsx(B,{size:16})]})]})]})})]}):null}export{se as LoanReview};
